flowchart TD
    %% User Entry Points
    Start([ðŸ‘¤ User Opens App]) --> Check{ðŸ” Authenticated?}
    
    %% Authentication Flow
    Check -->|No| Login[ðŸ”‘ Login Screen]
    Login --> Auth[ðŸ” Authentication]
    Auth --> API1[ðŸ“¡ POST /auth/login]
    API1 --> Backend1[ðŸ FastAPI - Users Router]
    Backend1 --> UserDB[(ðŸ‘¥ Users Database)]
    UserDB --> AuthResult{âœ… Valid Credentials?}
    AuthResult -->|Yes| MainApp[ðŸ“± Main Application]
    AuthResult -->|No| Login
    
    %% Direct to Main App if authenticated
    Check -->|Yes| MainApp
    
    %% Main Application Hub
    MainApp --> Features{ðŸŽ¯ Choose Feature}
    
    %% Inventory Management Flow
    Features -->|ðŸ“¦ Inventory| InvTable[ðŸ“‹ Inventory Table]
    InvTable --> InvActions{ðŸ”„ Action Type}
    
    InvActions -->|âž• Add Item| InvForm[ðŸ“ Inventory Form]
    InvActions -->|âœï¸ Edit Item| InvForm
    InvActions -->|ðŸ—‘ï¸ Delete Item| DeleteConf[â“ Confirm Delete]
    InvActions -->|ðŸ“Š View/Filter| TableOps[ðŸ” Table Operations]
    
    InvForm --> Validate{âœ… Valid Data?}
    Validate -->|No| InvForm
    Validate -->|Yes| API2[ðŸ“¡ POST/PUT /inventory]
    
    DeleteConf -->|Yes| API3[ðŸ“¡ DELETE /inventory/:id]
    DeleteConf -->|No| InvTable
    
    TableOps --> DragDrop[ðŸ–±ï¸ Drag & Drop Columns]
    TableOps --> Resize[ðŸ“ Resize Columns]
    TableOps --> Filter[ðŸ” Filter Data]
    DragDrop --> InvTable
    Resize --> InvTable
    Filter --> InvTable
    
    %% API to Backend for Inventory
    API2 --> Backend2[ðŸ FastAPI - Inventory Router]
    API3 --> Backend2
    Backend2 --> InvDB[(ðŸ“¦ Inventory Database)]
    InvDB --> InvResult[âœ… Operation Result]
    InvResult --> InvTable
    
    %% File Operations Flow
    Features -->|ðŸ“ File Operations| FileOps[ðŸ“„ File Manager]
    FileOps --> FileActions{ðŸ“‚ File Action}
    
    FileActions -->|ðŸ“¤ Export| ExportOps[ðŸ“¤ Export Options]
    FileActions -->|ðŸ” Inspect DB| DBInspect[ðŸ”Ž Database Inspector]
    
    ExportOps --> ExportType{ðŸ“‹ Export Type}
    ExportType -->|ðŸ“Š CSV| CSVExport[ðŸ“Š Generate CSV]
    ExportType -->|ðŸ“ˆ Excel| ExcelExport[ðŸ“ˆ Generate Excel]
    ExportType -->|ðŸ—ƒï¸ Database| DBExport[ðŸ—ƒï¸ Export Database]
    
    CSVExport --> Download1[â¬‡ï¸ Download File]
    ExcelExport --> Download2[â¬‡ï¸ Download File]
    DBExport --> Download3[â¬‡ï¸ Download File]
    
    DBInspect --> API4[ðŸ“¡ GET /inspect/:db]
    API4 --> Backend3[ðŸ FastAPI - Inspection]
    Backend3 --> AllDBs[(ðŸ—„ï¸ All Databases)]
    AllDBs --> InspectResult[ðŸ“‹ Inspection Data]
    InspectResult --> DBInspect
    
    %% Settings & Preferences Flow
    Features -->|âš™ï¸ Settings| Settings[âš™ï¸ Settings Page]
    Settings --> SettingsType{ðŸ”§ Setting Type}
    
    SettingsType -->|ðŸŽ¨ Theme| ThemeSettings[ðŸŽ¨ Theme Selector]
    SettingsType -->|ðŸ‘¤ User Management| UserMgmt[ðŸ‘¥ User Management]
    SettingsType -->|ðŸ“± Device Preferences| DevicePrefs[ðŸ“± Device Settings]
    
    %% Theme System Flow
    ThemeSettings --> ThemeSelect{ðŸŽ¨ Theme Choice}
    ThemeSelect -->|ðŸŒž Light| ApplyLight[â˜€ï¸ Apply Light Theme]
    ThemeSelect -->|ðŸŒ™ Dark| ApplyDark[ðŸŒ™ Apply Dark Theme]
    ThemeSelect -->|ðŸŽ¯ Custom| ApplyCustom[ðŸŽ¨ Apply Custom Theme]
    
    ApplyLight --> ThemeProvider[ðŸŽ¨ MultiDeviceThemeProvider]
    ApplyDark --> ThemeProvider
    ApplyCustom --> ThemeProvider
    
    ThemeProvider --> SaveTheme[ðŸ’¾ Save Theme Preference]
    SaveTheme --> API5[ðŸ“¡ POST /preferences]
    API5 --> Backend4[ðŸ FastAPI - Preferences Router]
    Backend4 --> PrefsDB[(âš™ï¸ Preferences Database)]
    PrefsDB --> ThemeStored[âœ… Theme Saved]
    ThemeStored --> ApplyCSS[ðŸŽ¨ Apply CSS Variables]
    ApplyCSS --> UIUpdate[ðŸ”„ Update UI]
    
    %% User Management Flow
    UserMgmt --> UserActions{ðŸ‘¤ User Action}
    UserActions -->|âž• Add User| AddUser[âž• Create User Form]
    UserActions -->|âœï¸ Edit User| EditUser[âœï¸ Edit User Form]
    UserActions -->|ðŸ—‘ï¸ Delete User| DeleteUser[â“ Confirm Delete User]
    
    AddUser --> UserValidate{âœ… Valid User Data?}
    EditUser --> UserValidate
    UserValidate -->|No| AddUser
    UserValidate -->|Yes| API6[ðŸ“¡ POST/PUT /users]
    
    DeleteUser -->|Yes| API7[ðŸ“¡ DELETE /users/:id]
    DeleteUser -->|No| UserMgmt
    
    API6 --> Backend1
    API7 --> Backend1
    
    %% Device Preferences Flow
    DevicePrefs --> DeviceActions{ðŸ“± Device Action}
    DeviceActions -->|ðŸ’¾ Backup| BackupDevice[ðŸ’¾ Backup Device Data]
    DeviceActions -->|ðŸ“¥ Restore| RestoreDevice[ðŸ“¥ Restore Device Data]
    DeviceActions -->|ðŸ”„ Sync| SyncDevice[ðŸ”„ Sync Across Devices]
    
    BackupDevice --> API8[ðŸ“¡ POST /preferences/backup]
    RestoreDevice --> API9[ðŸ“¡ GET /preferences/restore]
    SyncDevice --> API10[ðŸ“¡ POST /preferences/sync]
    
    API8 --> Backend4
    API9 --> Backend4
    API10 --> Backend4
    
    %% Mobile Responsiveness
    MainApp -.->|ðŸ“± Mobile Device| ResponsiveCheck{ðŸ“± Screen Size?}
    ResponsiveCheck -->|ðŸ“± Small| MobileUI[ðŸ“± Mobile Optimized UI]
    ResponsiveCheck -->|ðŸ’» Large| DesktopUI[ðŸ’» Desktop UI]
    
    MobileUI --> TouchFriendly[ðŸ‘† Touch-Friendly Components]
    MobileUI --> CollapsibleNav[ðŸ“± Collapsible Navigation]
    MobileUI --> OptimizedForms[ðŸ“ Optimized Forms]
    
    %% Error Handling
    API1 -.->|âŒ Error| ErrorHandler[âš ï¸ Error Handler]
    API2 -.->|âŒ Error| ErrorHandler
    API3 -.->|âŒ Error| ErrorHandler
    API4 -.->|âŒ Error| ErrorHandler
    API5 -.->|âŒ Error| ErrorHandler
    API6 -.->|âŒ Error| ErrorHandler
    API7 -.->|âŒ Error| ErrorHandler
    API8 -.->|âŒ Error| ErrorHandler
    API9 -.->|âŒ Error| ErrorHandler
    API10 -.->|âŒ Error| ErrorHandler
    
    ErrorHandler --> ShowError[ðŸš¨ Display Error Message]
    ShowError --> RetryOption{ðŸ”„ Retry Available?}
    RetryOption -->|Yes| RetryAction[ðŸ”„ Retry Operation]
    RetryOption -->|No| MainApp
    
    RetryAction --> Features
    
    %% Logout Flow
    MainApp -->|ðŸšª Logout| LogoutConfirm[â“ Confirm Logout]
    LogoutConfirm -->|Yes| ClearSession[ðŸ—‘ï¸ Clear Session]
    LogoutConfirm -->|No| MainApp
    ClearSession --> Start
    
    %% Styling
    classDef userAction fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    classDef apiCall fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef backend fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef database fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef theme fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef mobile fill:#e0f2f1,stroke:#00796b,stroke-width:2px
    
    class Start,MainApp,Login,Settings userAction
    class API1,API2,API3,API4,API5,API6,API7,API8,API9,API10 apiCall
    class Backend1,Backend2,Backend3,Backend4 backend
    class UserDB,InvDB,PrefsDB,AllDBs database
    class ThemeProvider,ApplyLight,ApplyDark,ApplyCustom,ApplyCSS theme
    class MobileUI,TouchFriendly,CollapsibleNav,OptimizedForms mobile